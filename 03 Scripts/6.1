{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "5bfacc41",
   "metadata": {},
   "source": [
    "# Table of contents"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b948c2bb",
   "metadata": {},
   "source": [
    "#### 1. import libraries and data sets"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "25b32410",
   "metadata": {},
   "source": [
    "#### 2. Data consistency checks"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dbc27e18",
   "metadata": {},
   "source": [
    "#### 3. Checking for null and duplicate values"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8ebf25fa",
   "metadata": {},
   "source": [
    "#### 4. Data wrangling"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7cc10630",
   "metadata": {},
   "source": [
    "# 1. import libraries and datasets"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c9a87034",
   "metadata": {},
   "source": [
    "## Insert libraries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "id": "3d42a3df",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import os"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "773c7f63",
   "metadata": {},
   "source": [
    "## Set file path"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "id": "035165f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "path = r'C:\\Users\\Andrew\\Desktop\\Data project'"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "93248be4",
   "metadata": {},
   "source": [
    "## import monthly datasets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "id": "a1ff49d7",
   "metadata": {},
   "outputs": [],
   "source": [
    "jan = pd.read_csv(os.path.join(path, '02 data', 'original', 'citi_jan22.csv'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "36aa386e",
   "metadata": {},
   "outputs": [],
   "source": [
    "feb = pd.read_csv(os.path.join(path, '02 data', 'original', 'citi_feb22.csv'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "id": "54c02069",
   "metadata": {},
   "outputs": [],
   "source": [
    "mar = pd.read_csv(os.path.join(path, '02 data', 'original', 'citi_mar22.csv'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "id": "a361a3a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "apr = pd.read_csv(os.path.join(path, '02 data', 'original', 'citi_apr22.csv'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "id": "b17614a8",
   "metadata": {},
   "outputs": [],
   "source": [
    "may = pd.read_csv(os.path.join(path, '02 data', 'original', 'citi_may22.csv'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "id": "cf78f973",
   "metadata": {},
   "outputs": [],
   "source": [
    "jun = pd.read_csv(os.path.join(path, '02 data', 'original', 'citi_jun22.csv'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "id": "c9de7dff",
   "metadata": {},
   "outputs": [],
   "source": [
    "jul = pd.read_csv(os.path.join(path, '02 data', 'original', 'citi_jul22.csv'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "id": "327fdea2",
   "metadata": {},
   "outputs": [],
   "source": [
    "aug = pd.read_csv(os.path.join(path, '02 data', 'original', 'citi_aug22.csv'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "id": "e2f90ba0",
   "metadata": {},
   "outputs": [],
   "source": [
    "sep = pd.read_csv(os.path.join(path, '02 data', 'original', 'citi_sep22.csv'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "id": "0508311c",
   "metadata": {},
   "outputs": [],
   "source": [
    "oct = pd.read_csv(os.path.join(path, '02 data', 'original', 'citi_oct22.csv'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "id": "5bb46377",
   "metadata": {},
   "outputs": [],
   "source": [
    "nov = pd.read_csv(os.path.join(path, '02 data', 'original', 'citi_nov22.csv'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "id": "319f19ba",
   "metadata": {},
   "outputs": [],
   "source": [
    "dec = pd.read_csv(os.path.join(path, '02 data', 'original', 'citi_dec22.csv'))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a59b55fd",
   "metadata": {},
   "source": [
    "## Join into one dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "id": "ad5e09a7",
   "metadata": {},
   "outputs": [],
   "source": [
    "frames = [jan, feb, mar, apr, may, jun, jul, aug, sep, oct, nov, dec]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "id": "3c302b5c",
   "metadata": {},
   "outputs": [],
   "source": [
    "citi22 = pd.concat(frames)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "281a6f00",
   "metadata": {},
   "source": [
    "# 2. Data consistency checks"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "id": "f3b0d38c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ride_id</th>\n",
       "      <th>rideable_type</th>\n",
       "      <th>started_at</th>\n",
       "      <th>ended_at</th>\n",
       "      <th>start_station_name</th>\n",
       "      <th>start_station_id</th>\n",
       "      <th>end_station_name</th>\n",
       "      <th>end_station_id</th>\n",
       "      <th>start_lat</th>\n",
       "      <th>start_lng</th>\n",
       "      <th>end_lat</th>\n",
       "      <th>end_lng</th>\n",
       "      <th>member_casual</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA5837152804D4B5</td>\n",
       "      <td>electric_bike</td>\n",
       "      <td>2022-01-26 18:50:39</td>\n",
       "      <td>2022-01-26 18:51:53</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>member</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>BA06A5E45B6601D2</td>\n",
       "      <td>classic_bike</td>\n",
       "      <td>2022-01-28 13:14:07</td>\n",
       "      <td>2022-01-28 13:20:23</td>\n",
       "      <td>Essex Light Rail</td>\n",
       "      <td>JC038</td>\n",
       "      <td>Essex Light Rail</td>\n",
       "      <td>JC038</td>\n",
       "      <td>40.712774</td>\n",
       "      <td>-74.036486</td>\n",
       "      <td>40.712774</td>\n",
       "      <td>-74.036486</td>\n",
       "      <td>member</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>7B6827D7B9508D93</td>\n",
       "      <td>classic_bike</td>\n",
       "      <td>2022-01-10 19:55:13</td>\n",
       "      <td>2022-01-10 20:00:37</td>\n",
       "      <td>Essex Light Rail</td>\n",
       "      <td>JC038</td>\n",
       "      <td>Essex Light Rail</td>\n",
       "      <td>JC038</td>\n",
       "      <td>40.712774</td>\n",
       "      <td>-74.036486</td>\n",
       "      <td>40.712774</td>\n",
       "      <td>-74.036486</td>\n",
       "      <td>member</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>6E5864EA6FCEC90D</td>\n",
       "      <td>electric_bike</td>\n",
       "      <td>2022-01-26 07:54:57</td>\n",
       "      <td>2022-01-26 07:55:22</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>member</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>E24954255BBDE32D</td>\n",
       "      <td>electric_bike</td>\n",
       "      <td>2022-01-13 18:44:46</td>\n",
       "      <td>2022-01-13 18:45:43</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>member</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            ride_id  rideable_type           started_at             ended_at  \\\n",
       "0  CA5837152804D4B5  electric_bike  2022-01-26 18:50:39  2022-01-26 18:51:53   \n",
       "1  BA06A5E45B6601D2   classic_bike  2022-01-28 13:14:07  2022-01-28 13:20:23   \n",
       "2  7B6827D7B9508D93   classic_bike  2022-01-10 19:55:13  2022-01-10 20:00:37   \n",
       "3  6E5864EA6FCEC90D  electric_bike  2022-01-26 07:54:57  2022-01-26 07:55:22   \n",
       "4  E24954255BBDE32D  electric_bike  2022-01-13 18:44:46  2022-01-13 18:45:43   \n",
       "\n",
       "     start_station_name start_station_id      end_station_name end_station_id  \\\n",
       "0  12 St & Sinatra Dr N            HB201  12 St & Sinatra Dr N          HB201   \n",
       "1      Essex Light Rail            JC038      Essex Light Rail          JC038   \n",
       "2      Essex Light Rail            JC038      Essex Light Rail          JC038   \n",
       "3  12 St & Sinatra Dr N            HB201  12 St & Sinatra Dr N          HB201   \n",
       "4  12 St & Sinatra Dr N            HB201  12 St & Sinatra Dr N          HB201   \n",
       "\n",
       "   start_lat  start_lng    end_lat    end_lng member_casual  \n",
       "0  40.750604 -74.024020  40.750604 -74.024020        member  \n",
       "1  40.712774 -74.036486  40.712774 -74.036486        member  \n",
       "2  40.712774 -74.036486  40.712774 -74.036486        member  \n",
       "3  40.750604 -74.024020  40.750604 -74.024020        member  \n",
       "4  40.750604 -74.024020  40.750604 -74.024020        member  "
      ]
     },
     "execution_count": 116,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "citi22.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "id": "17e9a46c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ride_id</th>\n",
       "      <th>rideable_type</th>\n",
       "      <th>started_at</th>\n",
       "      <th>ended_at</th>\n",
       "      <th>start_station_name</th>\n",
       "      <th>start_station_id</th>\n",
       "      <th>end_station_name</th>\n",
       "      <th>end_station_id</th>\n",
       "      <th>start_lat</th>\n",
       "      <th>start_lng</th>\n",
       "      <th>end_lat</th>\n",
       "      <th>end_lng</th>\n",
       "      <th>member_casual</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>48580</th>\n",
       "      <td>D438F1622839AC50</td>\n",
       "      <td>classic_bike</td>\n",
       "      <td>2022-12-06 15:43:38</td>\n",
       "      <td>2022-12-06 15:53:57</td>\n",
       "      <td>Dey St</td>\n",
       "      <td>JC065</td>\n",
       "      <td>Riverview Park</td>\n",
       "      <td>JC057</td>\n",
       "      <td>40.737828</td>\n",
       "      <td>-74.067083</td>\n",
       "      <td>40.744319</td>\n",
       "      <td>-74.043991</td>\n",
       "      <td>member</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48581</th>\n",
       "      <td>747A63A8E782D171</td>\n",
       "      <td>electric_bike</td>\n",
       "      <td>2022-12-08 08:17:51</td>\n",
       "      <td>2022-12-08 08:23:33</td>\n",
       "      <td>9 St HBLR - Jackson St &amp; 8 St</td>\n",
       "      <td>HB305</td>\n",
       "      <td>City Hall - Washington St &amp; 1 St</td>\n",
       "      <td>HB105</td>\n",
       "      <td>40.747907</td>\n",
       "      <td>-74.038412</td>\n",
       "      <td>40.737360</td>\n",
       "      <td>-74.030970</td>\n",
       "      <td>casual</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48582</th>\n",
       "      <td>AE090858CFDE6E82</td>\n",
       "      <td>electric_bike</td>\n",
       "      <td>2022-12-23 14:10:07</td>\n",
       "      <td>2022-12-23 14:14:18</td>\n",
       "      <td>Mama Johnson Field - 4 St &amp; Jackson St</td>\n",
       "      <td>HB404</td>\n",
       "      <td>City Hall - Washington St &amp; 1 St</td>\n",
       "      <td>HB105</td>\n",
       "      <td>40.743140</td>\n",
       "      <td>-74.040041</td>\n",
       "      <td>40.737360</td>\n",
       "      <td>-74.030970</td>\n",
       "      <td>member</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48583</th>\n",
       "      <td>B3CC8E70AF4E259C</td>\n",
       "      <td>classic_bike</td>\n",
       "      <td>2022-12-02 04:43:25</td>\n",
       "      <td>2022-12-02 04:46:55</td>\n",
       "      <td>Mama Johnson Field - 4 St &amp; Jackson St</td>\n",
       "      <td>HB404</td>\n",
       "      <td>City Hall - Washington St &amp; 1 St</td>\n",
       "      <td>HB105</td>\n",
       "      <td>40.743135</td>\n",
       "      <td>-74.040080</td>\n",
       "      <td>40.737360</td>\n",
       "      <td>-74.030970</td>\n",
       "      <td>member</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48584</th>\n",
       "      <td>176B601F21327350</td>\n",
       "      <td>classic_bike</td>\n",
       "      <td>2022-12-30 14:50:17</td>\n",
       "      <td>2022-12-30 14:55:37</td>\n",
       "      <td>14 St Ferry - 14 St &amp; Shipyard Ln</td>\n",
       "      <td>HB202</td>\n",
       "      <td>City Hall - Washington St &amp; 1 St</td>\n",
       "      <td>HB105</td>\n",
       "      <td>40.752747</td>\n",
       "      <td>-74.024035</td>\n",
       "      <td>40.737360</td>\n",
       "      <td>-74.030970</td>\n",
       "      <td>member</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                ride_id  rideable_type           started_at  \\\n",
       "48580  D438F1622839AC50   classic_bike  2022-12-06 15:43:38   \n",
       "48581  747A63A8E782D171  electric_bike  2022-12-08 08:17:51   \n",
       "48582  AE090858CFDE6E82  electric_bike  2022-12-23 14:10:07   \n",
       "48583  B3CC8E70AF4E259C   classic_bike  2022-12-02 04:43:25   \n",
       "48584  176B601F21327350   classic_bike  2022-12-30 14:50:17   \n",
       "\n",
       "                  ended_at                      start_station_name  \\\n",
       "48580  2022-12-06 15:53:57                                  Dey St   \n",
       "48581  2022-12-08 08:23:33           9 St HBLR - Jackson St & 8 St   \n",
       "48582  2022-12-23 14:14:18  Mama Johnson Field - 4 St & Jackson St   \n",
       "48583  2022-12-02 04:46:55  Mama Johnson Field - 4 St & Jackson St   \n",
       "48584  2022-12-30 14:55:37       14 St Ferry - 14 St & Shipyard Ln   \n",
       "\n",
       "      start_station_id                  end_station_name end_station_id  \\\n",
       "48580            JC065                    Riverview Park          JC057   \n",
       "48581            HB305  City Hall - Washington St & 1 St          HB105   \n",
       "48582            HB404  City Hall - Washington St & 1 St          HB105   \n",
       "48583            HB404  City Hall - Washington St & 1 St          HB105   \n",
       "48584            HB202  City Hall - Washington St & 1 St          HB105   \n",
       "\n",
       "       start_lat  start_lng    end_lat    end_lng member_casual  \n",
       "48580  40.737828 -74.067083  40.744319 -74.043991        member  \n",
       "48581  40.747907 -74.038412  40.737360 -74.030970        casual  \n",
       "48582  40.743140 -74.040041  40.737360 -74.030970        member  \n",
       "48583  40.743135 -74.040080  40.737360 -74.030970        member  \n",
       "48584  40.752747 -74.024035  40.737360 -74.030970        member  "
      ]
     },
     "execution_count": 117,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "citi22.tail()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "id": "f9bac86a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 895485 entries, 0 to 48584\n",
      "Data columns (total 13 columns):\n",
      " #   Column              Non-Null Count   Dtype  \n",
      "---  ------              --------------   -----  \n",
      " 0   ride_id             895485 non-null  object \n",
      " 1   rideable_type       895485 non-null  object \n",
      " 2   started_at          895485 non-null  object \n",
      " 3   ended_at            895485 non-null  object \n",
      " 4   start_station_name  895475 non-null  object \n",
      " 5   start_station_id    895475 non-null  object \n",
      " 6   end_station_name    892281 non-null  object \n",
      " 7   end_station_id      892281 non-null  object \n",
      " 8   start_lat           895485 non-null  float64\n",
      " 9   start_lng           895485 non-null  float64\n",
      " 10  end_lat             893515 non-null  float64\n",
      " 11  end_lng             893515 non-null  float64\n",
      " 12  member_casual       895485 non-null  object \n",
      "dtypes: float64(4), object(9)\n",
      "memory usage: 95.6+ MB\n"
     ]
    }
   ],
   "source": [
    "citi22.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "id": "ff957658",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(895485, 13)"
      ]
     },
     "execution_count": 119,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "citi22.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 125,
   "id": "e4cba0d7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>start_lat</th>\n",
       "      <th>start_lng</th>\n",
       "      <th>end_lat</th>\n",
       "      <th>end_lng</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>895485.000000</td>\n",
       "      <td>895485.000000</td>\n",
       "      <td>893515.000000</td>\n",
       "      <td>893515.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>40.731927</td>\n",
       "      <td>-74.040461</td>\n",
       "      <td>40.731868</td>\n",
       "      <td>-74.040205</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>0.012095</td>\n",
       "      <td>0.012219</td>\n",
       "      <td>0.012222</td>\n",
       "      <td>0.012178</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>40.706495</td>\n",
       "      <td>-74.088964</td>\n",
       "      <td>40.640000</td>\n",
       "      <td>-74.140000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>40.721124</td>\n",
       "      <td>-74.046305</td>\n",
       "      <td>40.721124</td>\n",
       "      <td>-74.045953</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>40.733670</td>\n",
       "      <td>-74.037977</td>\n",
       "      <td>40.733670</td>\n",
       "      <td>-74.037977</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>40.740973</td>\n",
       "      <td>-74.030970</td>\n",
       "      <td>40.740973</td>\n",
       "      <td>-74.030970</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>40.754992</td>\n",
       "      <td>-74.023490</td>\n",
       "      <td>40.872412</td>\n",
       "      <td>-73.888271</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           start_lat      start_lng        end_lat        end_lng\n",
       "count  895485.000000  895485.000000  893515.000000  893515.000000\n",
       "mean       40.731927     -74.040461      40.731868     -74.040205\n",
       "std         0.012095       0.012219       0.012222       0.012178\n",
       "min        40.706495     -74.088964      40.640000     -74.140000\n",
       "25%        40.721124     -74.046305      40.721124     -74.045953\n",
       "50%        40.733670     -74.037977      40.733670     -74.037977\n",
       "75%        40.740973     -74.030970      40.740973     -74.030970\n",
       "max        40.754992     -74.023490      40.872412     -73.888271"
      ]
     },
     "execution_count": 125,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "citi22.describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6a6ee1ac",
   "metadata": {},
   "source": [
    "# 3. Checking for null and duplicate values"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8523b9d4",
   "metadata": {},
   "source": [
    "## Check for null values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 127,
   "id": "2c17d636",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ride_id                  0\n",
       "rideable_type            0\n",
       "started_at               0\n",
       "ended_at                 0\n",
       "start_station_name      10\n",
       "start_station_id        10\n",
       "end_station_name      3204\n",
       "end_station_id        3204\n",
       "start_lat                0\n",
       "start_lng                0\n",
       "end_lat               1970\n",
       "end_lng               1970\n",
       "member_casual            0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 127,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "citi22.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "id": "5eae7871",
   "metadata": {},
   "outputs": [],
   "source": [
    "citi22_nulls = citi22[citi22['end_station_name'].isnull() == True]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "id": "dfa4b27b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ride_id</th>\n",
       "      <th>rideable_type</th>\n",
       "      <th>start_station_name</th>\n",
       "      <th>start_station_id</th>\n",
       "      <th>end_station_name</th>\n",
       "      <th>end_station_id</th>\n",
       "      <th>start_lat</th>\n",
       "      <th>start_lng</th>\n",
       "      <th>end_lat</th>\n",
       "      <th>end_lng</th>\n",
       "      <th>member_casual</th>\n",
       "      <th>start_date</th>\n",
       "      <th>start_time</th>\n",
       "      <th>end_date</th>\n",
       "      <th>end_time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>11859</th>\n",
       "      <td>4A898152CB214964</td>\n",
       "      <td>classic_bike</td>\n",
       "      <td>Essex Light Rail</td>\n",
       "      <td>JC038</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>40.712774</td>\n",
       "      <td>-74.036486</td>\n",
       "      <td>40.72</td>\n",
       "      <td>-74.05</td>\n",
       "      <td>casual</td>\n",
       "      <td>2022-01-17</td>\n",
       "      <td>07:24:48</td>\n",
       "      <td>2022-01-17</td>\n",
       "      <td>11:00:40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12057</th>\n",
       "      <td>72EAE1956F866E17</td>\n",
       "      <td>classic_bike</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>40.75</td>\n",
       "      <td>-74.03</td>\n",
       "      <td>member</td>\n",
       "      <td>2022-01-12</td>\n",
       "      <td>17:29:07</td>\n",
       "      <td>2022-01-13</td>\n",
       "      <td>05:38:13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12060</th>\n",
       "      <td>B86D962AFBB06C65</td>\n",
       "      <td>classic_bike</td>\n",
       "      <td>Essex Light Rail</td>\n",
       "      <td>JC038</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>40.712774</td>\n",
       "      <td>-74.036486</td>\n",
       "      <td>40.72</td>\n",
       "      <td>-74.03</td>\n",
       "      <td>member</td>\n",
       "      <td>2022-01-13</td>\n",
       "      <td>08:36:16</td>\n",
       "      <td>2022-01-13</td>\n",
       "      <td>18:44:27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12061</th>\n",
       "      <td>2FBC10413DA8548B</td>\n",
       "      <td>classic_bike</td>\n",
       "      <td>Essex Light Rail</td>\n",
       "      <td>JC038</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>40.712774</td>\n",
       "      <td>-74.036486</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>member</td>\n",
       "      <td>2022-01-16</td>\n",
       "      <td>10:19:03</td>\n",
       "      <td>2022-01-17</td>\n",
       "      <td>11:18:57</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12062</th>\n",
       "      <td>6310079AA874852E</td>\n",
       "      <td>classic_bike</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>casual</td>\n",
       "      <td>2022-01-08</td>\n",
       "      <td>10:35:31</td>\n",
       "      <td>2022-01-09</td>\n",
       "      <td>11:35:26</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                ride_id rideable_type    start_station_name start_station_id  \\\n",
       "11859  4A898152CB214964  classic_bike      Essex Light Rail            JC038   \n",
       "12057  72EAE1956F866E17  classic_bike  12 St & Sinatra Dr N            HB201   \n",
       "12060  B86D962AFBB06C65  classic_bike      Essex Light Rail            JC038   \n",
       "12061  2FBC10413DA8548B  classic_bike      Essex Light Rail            JC038   \n",
       "12062  6310079AA874852E  classic_bike  12 St & Sinatra Dr N            HB201   \n",
       "\n",
       "      end_station_name end_station_id  start_lat  start_lng  end_lat  end_lng  \\\n",
       "11859              NaN            NaN  40.712774 -74.036486    40.72   -74.05   \n",
       "12057              NaN            NaN  40.750604 -74.024020    40.75   -74.03   \n",
       "12060              NaN            NaN  40.712774 -74.036486    40.72   -74.03   \n",
       "12061              NaN            NaN  40.712774 -74.036486      NaN      NaN   \n",
       "12062              NaN            NaN  40.750604 -74.024020      NaN      NaN   \n",
       "\n",
       "      member_casual  start_date start_time    end_date  end_time  \n",
       "11859        casual  2022-01-17   07:24:48  2022-01-17  11:00:40  \n",
       "12057        member  2022-01-12   17:29:07  2022-01-13  05:38:13  \n",
       "12060        member  2022-01-13   08:36:16  2022-01-13  18:44:27  \n",
       "12061        member  2022-01-16   10:19:03  2022-01-17  11:18:57  \n",
       "12062        casual  2022-01-08   10:35:31  2022-01-09  11:35:26  "
      ]
     },
     "execution_count": 154,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "citi22_nulls.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "af85e577",
   "metadata": {},
   "source": [
    "### These null values will no affect our analysis therefore we do not need to take further action"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9661124a",
   "metadata": {},
   "source": [
    "## Create frame for duplicates"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "id": "eb5cee69",
   "metadata": {},
   "outputs": [],
   "source": [
    "citi22_dups = citi22[citi22.duplicated()]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a305a940",
   "metadata": {},
   "source": [
    "## Check count of duplicates"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "id": "a9e8c79c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Series([], dtype: int64)"
      ]
     },
     "execution_count": 134,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "citi22_dups.value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "44a39d09",
   "metadata": {},
   "source": [
    "# 4. Data wrangling"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "734f5448",
   "metadata": {},
   "source": [
    "## Separate start/end at variables into date and time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "id": "68f1e4d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "citi22['start_date'] = pd.to_datetime(citi22['started_at']).dt.date\n",
    "citi22['start_time'] = pd.to_datetime(citi22['started_at']).dt.time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "id": "695fef35",
   "metadata": {},
   "outputs": [],
   "source": [
    "citi22['end_date'] = pd.to_datetime(citi22['ended_at']).dt.date\n",
    "citi22['end_time'] = pd.to_datetime(citi22['ended_at']).dt.time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 142,
   "id": "d5fd2d06",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 895485 entries, 0 to 48584\n",
      "Data columns (total 17 columns):\n",
      " #   Column              Non-Null Count   Dtype  \n",
      "---  ------              --------------   -----  \n",
      " 0   ride_id             895485 non-null  object \n",
      " 1   rideable_type       895485 non-null  object \n",
      " 2   started_at          895485 non-null  object \n",
      " 3   ended_at            895485 non-null  object \n",
      " 4   start_station_name  895475 non-null  object \n",
      " 5   start_station_id    895475 non-null  object \n",
      " 6   end_station_name    892281 non-null  object \n",
      " 7   end_station_id      892281 non-null  object \n",
      " 8   start_lat           895485 non-null  float64\n",
      " 9   start_lng           895485 non-null  float64\n",
      " 10  end_lat             893515 non-null  float64\n",
      " 11  end_lng             893515 non-null  float64\n",
      " 12  member_casual       895485 non-null  object \n",
      " 13  start_date          895485 non-null  object \n",
      " 14  start_time          895485 non-null  object \n",
      " 15  end_date            895485 non-null  object \n",
      " 16  end_time            895485 non-null  object \n",
      "dtypes: float64(4), object(13)\n",
      "memory usage: 123.0+ MB\n"
     ]
    }
   ],
   "source": [
    "citi22.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1e88a8b3",
   "metadata": {},
   "source": [
    "## Remove started_at and ended_at columns since we split into new columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 144,
   "id": "f33c832f",
   "metadata": {},
   "outputs": [],
   "source": [
    "citi22 = citi22.drop(columns = ['started_at', 'ended_at'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 145,
   "id": "e7adb01e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ride_id</th>\n",
       "      <th>rideable_type</th>\n",
       "      <th>start_station_name</th>\n",
       "      <th>start_station_id</th>\n",
       "      <th>end_station_name</th>\n",
       "      <th>end_station_id</th>\n",
       "      <th>start_lat</th>\n",
       "      <th>start_lng</th>\n",
       "      <th>end_lat</th>\n",
       "      <th>end_lng</th>\n",
       "      <th>member_casual</th>\n",
       "      <th>start_date</th>\n",
       "      <th>start_time</th>\n",
       "      <th>end_date</th>\n",
       "      <th>end_time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA5837152804D4B5</td>\n",
       "      <td>electric_bike</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>member</td>\n",
       "      <td>2022-01-26</td>\n",
       "      <td>18:50:39</td>\n",
       "      <td>2022-01-26</td>\n",
       "      <td>18:51:53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>BA06A5E45B6601D2</td>\n",
       "      <td>classic_bike</td>\n",
       "      <td>Essex Light Rail</td>\n",
       "      <td>JC038</td>\n",
       "      <td>Essex Light Rail</td>\n",
       "      <td>JC038</td>\n",
       "      <td>40.712774</td>\n",
       "      <td>-74.036486</td>\n",
       "      <td>40.712774</td>\n",
       "      <td>-74.036486</td>\n",
       "      <td>member</td>\n",
       "      <td>2022-01-28</td>\n",
       "      <td>13:14:07</td>\n",
       "      <td>2022-01-28</td>\n",
       "      <td>13:20:23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>7B6827D7B9508D93</td>\n",
       "      <td>classic_bike</td>\n",
       "      <td>Essex Light Rail</td>\n",
       "      <td>JC038</td>\n",
       "      <td>Essex Light Rail</td>\n",
       "      <td>JC038</td>\n",
       "      <td>40.712774</td>\n",
       "      <td>-74.036486</td>\n",
       "      <td>40.712774</td>\n",
       "      <td>-74.036486</td>\n",
       "      <td>member</td>\n",
       "      <td>2022-01-10</td>\n",
       "      <td>19:55:13</td>\n",
       "      <td>2022-01-10</td>\n",
       "      <td>20:00:37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>6E5864EA6FCEC90D</td>\n",
       "      <td>electric_bike</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>member</td>\n",
       "      <td>2022-01-26</td>\n",
       "      <td>07:54:57</td>\n",
       "      <td>2022-01-26</td>\n",
       "      <td>07:55:22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>E24954255BBDE32D</td>\n",
       "      <td>electric_bike</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>12 St &amp; Sinatra Dr N</td>\n",
       "      <td>HB201</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>40.750604</td>\n",
       "      <td>-74.024020</td>\n",
       "      <td>member</td>\n",
       "      <td>2022-01-13</td>\n",
       "      <td>18:44:46</td>\n",
       "      <td>2022-01-13</td>\n",
       "      <td>18:45:43</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            ride_id  rideable_type    start_station_name start_station_id  \\\n",
       "0  CA5837152804D4B5  electric_bike  12 St & Sinatra Dr N            HB201   \n",
       "1  BA06A5E45B6601D2   classic_bike      Essex Light Rail            JC038   \n",
       "2  7B6827D7B9508D93   classic_bike      Essex Light Rail            JC038   \n",
       "3  6E5864EA6FCEC90D  electric_bike  12 St & Sinatra Dr N            HB201   \n",
       "4  E24954255BBDE32D  electric_bike  12 St & Sinatra Dr N            HB201   \n",
       "\n",
       "       end_station_name end_station_id  start_lat  start_lng    end_lat  \\\n",
       "0  12 St & Sinatra Dr N          HB201  40.750604 -74.024020  40.750604   \n",
       "1      Essex Light Rail          JC038  40.712774 -74.036486  40.712774   \n",
       "2      Essex Light Rail          JC038  40.712774 -74.036486  40.712774   \n",
       "3  12 St & Sinatra Dr N          HB201  40.750604 -74.024020  40.750604   \n",
       "4  12 St & Sinatra Dr N          HB201  40.750604 -74.024020  40.750604   \n",
       "\n",
       "     end_lng member_casual  start_date start_time    end_date  end_time  \n",
       "0 -74.024020        member  2022-01-26   18:50:39  2022-01-26  18:51:53  \n",
       "1 -74.036486        member  2022-01-28   13:14:07  2022-01-28  13:20:23  \n",
       "2 -74.036486        member  2022-01-10   19:55:13  2022-01-10  20:00:37  \n",
       "3 -74.024020        member  2022-01-26   07:54:57  2022-01-26  07:55:22  \n",
       "4 -74.024020        member  2022-01-13   18:44:46  2022-01-13  18:45:43  "
      ]
     },
     "execution_count": 145,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "citi22.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d5ba662f",
   "metadata": {},
   "source": [
    "## column renames"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e3930203",
   "metadata": {},
   "outputs": [],
   "source": [
    "citi22.rename(columns '')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "87e60182",
   "metadata": {},
   "source": [
    "## export df to pickle file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 149,
   "id": "6324c920",
   "metadata": {},
   "outputs": [],
   "source": [
    "citi22.to_pickle(os.path.join(path, '02 data', 'clean', 'citi22.pkl'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "206622b8",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
